{{#ifEquals dbType  "turso"}}
import { createClient as createLibsqlClient } from "@libsql/client";
import { drizzle } from "drizzle-orm/libsql";
{{/ifEquals}}
{{#ifEquals dbType  "postgres"}}
import { drizzle } from "drizzle-orm/node-postgres"
{{/ifEquals}}

import * as schema from "../../drizzle/schema";

{{#ifEquals dbType  "postgres"}}
export const createClient = ({ url }: { url: string }) => {
  return drizzle(url, { schema });
};
{{/ifEquals}}
{{#ifEquals dbType  "turso"}}
export const createClient = ({
  url,
  syncUrl,
  authToken,
}: {
  url: string;
  syncUrl?: string;
  authToken?: string;
}) => {
  const client = createLibsqlClient({
    url,
    syncUrl,
    authToken,
    syncInterval: syncUrl ? 60 : undefined,
  });

  return drizzle(client, { schema });
};
{{/ifEquals}}
export type DrizzleClient = ReturnType<typeof createClient>;
